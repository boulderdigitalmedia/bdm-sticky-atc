{%- comment -%}
  Sticky Add to Cart – Checkout Attribution Block

  This block is injected at checkout to help attribute
  conversions back to Sticky ATC events.
  It does not render visible UI.
{%- endcomment -%}

<script>
  (function () {
    try {
      if (!window.Shopify || !Shopify.checkout) return;

      const payload = {
        event: "checkout_loaded",
        checkout_token: Shopify.checkout.token,
        shop: Shopify.shop,
        timestamp: Date.now(),
      };

      fetch("https://sticky-add-to-cart-bar-pro.onrender.com/apps/bdm-sticky-atc/checkout", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload),
      });
    } catch (e) {
      console.warn("Sticky ATC checkout attribution error", e);
    }
  })();
</script>

{% schema %}
{
  "name": "Sticky ATC – Checkout Attribution",
  "target": "head",
  "settings": []
}
{% endschema %}
